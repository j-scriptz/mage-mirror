; ========= CORE LIMITS =========

; Magento chews RAM. 2G is a comfy dev value.
memory_limit = 2G

; You usually want no execution time limit in CLI/dev.
max_execution_time = 0
max_input_time = 60

; A lot of Magento admin forms are huge.
max_input_vars = 20000
post_max_size  = 64M
upload_max_filesize = 64M


; ========= OPCACHE (HUGE FOR PERFORMANCE) =========

; Enable opcache
opcache.enable = 1
opcache.enable_cli = 1   ; nice for bin/magento performance in dev

; Size of the shared memory storage in MB
opcache.memory_consumption = 512

; Number of interned strings in MB
opcache.interned_strings_buffer = 16

; Max number of cacheable scripts
opcache.max_accelerated_files = 65407

; Validate file timestamps to see if scripts changed
; For dev you usually want this ON with a short revalidate frequency.
opcache.validate_timestamps = 1

; How often (in seconds) to check script timestamps
; 0  = check every request (slower but “always fresh”)
; 2–10 = good compromise for dev
opcache.revalidate_freq = 2

; Save comments = needed for some Magento reflection/attributes
opcache.save_comments = 1

; Faster hash algorithm (PHP 8, optional)
opcache.optimization_level = 0x7FFFBFFF


; ========= REALPATH CACHE =========

; Magento does a ton of filesystem lookups.
realpath_cache_size = 4096K
realpath_cache_ttl  = 600


; ========= LOGGING / ERRORS =========

; In dev, you want errors logged, not splatted into HTML.
display_errors = 0
log_errors = 1
error_log = /var/log/php-error.log

; Don’t blow up on deprecations in CLI (you already filtered some via -d)
error_reporting = E_ALL & ~E_DEPRECATED & ~E_USER_DEPRECATED


; ========= SESSION =========

; File sessions are fine for local Warden
session.gc_maxlifetime = 1440
session.save_handler = files
